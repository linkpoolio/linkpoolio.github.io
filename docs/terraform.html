<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Use of Terraform · </title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;When LinkPool was being built, the automation of the platform was of a&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Use of Terraform · "/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.linkpool.io/index.html"/><meta property="og:description" content="&lt;p&gt;When LinkPool was being built, the automation of the platform was of a&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.svg" alt=""/><h2 class="headerTitleWithLogo"></h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/overview" target="_self">Chainlinks</a></li><li class="siteNavGroupActive"><a href="/docs/rpc_ropsten" target="_self">Ethereum RPC</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/docs/terraform" target="_self">Design</a></li><li class=""><a href="/contact" target="_self">Contact us</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Infrastructure Design</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Example Chainlinks</h3><ul><li class="navListItem"><a class="navItem" href="/docs/overview">Overview</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Ropsten</h4><ul><li class="navListItem"><a class="navItem" href="/docs/asset_price_ropsten">Asset Price</a></li><li class="navListItem"><a class="navItem" href="/docs/alpha_vantage_ropsten">Alpha Vantage</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul><li class="navListItem"><a class="navItem" href="/docs/node_rpc">Node Setup Guide (LP EaaS)</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Public Ethereum RPC</h3><ul><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Ropsten</h4><ul><li class="navListItem"><a class="navItem" href="/docs/rpc_ropsten">RPC</a></li><li class="navListItem"><a class="navItem" href="/docs/websocket_ropsten">WebSocket</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Main (Foundation)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/rpc_main">RPC</a></li><li class="navListItem"><a class="navItem" href="/docs/websocket_main">WebSocket</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Infrastructure Design</h3><ul><li class="navListItem navListItemActive"><a class="navItem" href="/docs/terraform">Use of Terraform</a></li><li class="navListItem"><a class="navItem" href="/docs/parity">Parity</a></li><li class="navListItem"><a class="navItem" href="/docs/parity_light">Parity Light (Public RPCs)</a></li><li class="navListItem"><a class="navItem" href="/docs/nodes">Chainlink Nodes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Contract Design</h3><ul><li class="navListItem"><a class="navItem" href="/docs/contracts">Contract Source</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Use of Terraform</h1></header><article><div><span><p>When LinkPool was being built, the automation of the platform was of a
critical importance to its operation. With a high level of automation,
it drastically cuts the amount of resource we need to operate; reduces
the level of human error and slashes the time it takes to scale and
re-create environments.</p>
<p>This is why <a href="https://www.terraform.io/">Terraform</a> was chosen, as it
allows for descriptive code that defines, provisions and manages all
aspects of infrastructure.</p>
<h2><a class="anchor" aria-hidden="true" id="scale-of-use"></a><a href="#scale-of-use" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scale of Use</h2>
<p>Terraform describes all of our AWS resources bar a few Route53 records.
Since it's used so extensively, the applying of changes is managed
in our internal CI platform, requiring permissioned approval on each
infrastructure update.</p>
<h2><a class="anchor" aria-hidden="true" id="source-code"></a><a href="#source-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source Code</h2>
<p>With Terraform describing all our infrastructure, it will remain closed
source in internal repositories.</p>
<h3><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Below is a code snippet describing all the paramters for our Ropsten
nodes:</p>
<pre><code class="hljs css language-tf">module <span class="hljs-string">"ropsten_nodes"</span> {
  <span class="hljs-attr">source</span> = <span class="hljs-string">"git::ssh://&lt;redacted&gt;/terraform-modules/node.git"</span>

  <span class="hljs-attr">vpc_id</span>             = <span class="hljs-string">"<span class="hljs-subst">${aws_vpc.poolnodes_ropsten.id}</span>"</span>
  <span class="hljs-attr">vpc_cidr</span>           = <span class="hljs-string">"<span class="hljs-subst">${aws_vpc.poolnodes_ropsten.cidr_block}</span>"</span>
  <span class="hljs-attr">availability_zones</span> = <span class="hljs-string">"<span class="hljs-subst">${data.aws_availability_zones.available.names}</span>"</span>
  <span class="hljs-attr">subnets</span>            = <span class="hljs-string">"<span class="hljs-subst">${aws_subnet.poolnodes_ropsten.*.id}</span>"</span>
  <span class="hljs-attr">security_group</span>     = <span class="hljs-string">"<span class="hljs-subst">${aws_security_group.poolnode_host_ropsten.id}</span>"</span>
  <span class="hljs-attr">efs_security_group</span> = <span class="hljs-string">"<span class="hljs-subst">${aws_security_group.efs_ropsten.id}</span>"</span>
  <span class="hljs-attr">vpn_security_group</span> = <span class="hljs-string">"<span class="hljs-subst">${module.openvpn.security_group}</span>"</span>
  <span class="hljs-attr">hosted_zone</span>        = <span class="hljs-string">"<span class="hljs-subst">${aws_route53_zone.poolnodes_ropsten.id}</span>"</span>
  <span class="hljs-attr">cert_arn</span>           = <span class="hljs-string">"<span class="hljs-subst">${aws_acm_certificate.ropsten_cert.arn}</span>"</span>
  <span class="hljs-attr">service_discovery</span>  = <span class="hljs-string">"<span class="hljs-subst">${aws_service_discovery_private_dns_namespace.ropsten.id}</span>"</span>
  <span class="hljs-attr">sns_topic</span>          = <span class="hljs-string">"<span class="hljs-subst">${aws_sns_topic.pagerduty.arn}</span>"</span>
  <span class="hljs-attr">cluster</span>            = <span class="hljs-string">"poolnodes"</span>
  <span class="hljs-attr">family</span>             = <span class="hljs-string">"ropsten"</span>
  <span class="hljs-attr">es_lambda</span>          = <span class="hljs-string">"<span class="hljs-subst">${aws_lambda_function.cwl_stream_lambda.arn}</span>"</span>
  <span class="hljs-attr">patch_group</span>        = <span class="hljs-string">"ropsten"</span>
  <span class="hljs-attr">cwl_endpoint</span>       = <span class="hljs-string">"logs.<span class="hljs-subst">${data.aws_region.current.name}</span>.amazonaws.com"</span>

  <span class="hljs-attr">eth_chain_id</span>          = <span class="hljs-string">"3"</span>
  <span class="hljs-attr">eth_ws_uri</span>            = <span class="hljs-string">"ws://<span class="hljs-subst">${module.ropsten_parity.lb_ws_fqdn}</span>"</span>
  <span class="hljs-attr">total_node_services</span>   = <span class="hljs-string">"<span class="hljs-subst">${var.ropsten_node_count}</span>"</span>
  <span class="hljs-attr">node_per_service</span>      = <span class="hljs-number">2</span>
  <span class="hljs-attr">node_version</span>          = <span class="hljs-string">"v0.35"</span>
  <span class="hljs-attr">link_contract_address</span> = <span class="hljs-string">"0x20fe562d797a42dcb3399062ae9546cd06f63280"</span>
}
</code></pre>
<p>This code block in Terraform is the inclusion of a module. The module
contains resources that create EC2 instances, scaling groups, DNS entries
and how many nodes are provisioned etc. By using modules, it allows us
to easily create new environments that are all in-sync and scale easily.</p>
<p><strong>Practical example:</strong> If we change <code>node_version</code>, it will trigger a rolling
update across that node cluster, gradually replacing all nodes with the
later version automatically.</p>
<p>This pattern of module inclusion is the common theme through our entire
codebase, with resources only being defined in the parent repo only if
they're typically shared with multiple resources.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/websocket_main"><span class="arrow-prev">← </span><span class="function-name-prevnext">Main (Foundation) WebSocket</span></a><a class="docs-next button" href="/docs/parity"><span>Parity Design</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#scale-of-use">Scale of Use</a></li><li><a href="#source-code">Source Code</a><ul class="toc-headings"><li><a href="#example">Example</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo.svg" alt="" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/overview.html">Chainlinks</a><a href="/docs/en/rpc_ropsten.html">Public Ethereum RPCs</a><a href="/docs/en/terraform.html">Infrastructure Design</a></div><div><h5>Community</h5><a href="https://t.me/linkpoolio" target="_blank" rel="noreferrer noopener">Telegram</a><a href="https://twitter.com/linkpoolio" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/contact">Contact us</a><a href="https://linkpool.io">Website</a><a href="https://staking.linkpool.io">App</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 LinkPool</section></footer></div></body></html>